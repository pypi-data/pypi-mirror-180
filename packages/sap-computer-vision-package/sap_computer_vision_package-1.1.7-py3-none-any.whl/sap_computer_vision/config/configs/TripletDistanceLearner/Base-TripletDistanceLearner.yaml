MODEL:
  META_ARCHITECTURE: "TripletDistanceLearner"
  FEATURE_EXTRACTION:
    PROJECTION_SIZE: 500
    INTERMEDIATE_SIZE:
      - 1000
    DROPOUT_FC: 0.5
    IN_FEATURES: null
    POOL_BACKBONE_FEATURES: True
    NORMALIZE_OUTPUT: True
    FREEZE_BACKBONE: False
  TRIPLET_DISTANCE_LEARNER:
    LOSS: MARGIN_LOSS
    CIRCLE_LOSS:
      MARGIN: 0.25
      GAMMA: 256
    MARGIN_LOSS:
      MARGIN: 0.25
      NORM: 2
      SWAP: True
      SELECTIVE: False
    NCA_LOSS:
      LAMBDA: 0.1
      SWAP: True
      SELECTIVE: False
    TRIPLET_STRATEGY: ['*', '*']

DATALOADER:
  ASPECT_RATIO_GROUPING: False
  SAMPLER_TRAIN: PKSampler
  PK_SAMPLER:
    P_CLASSES_PER_BATCH: 16
    K_EXAMPLES_PER_CLASS: 4
    IGNORE_CLASS_WEIGHTS: False
    STRATEGY_SWITCHES: []
  TRIPLET_RESERVOIR_SAMPLER:
    N_BATCHES_PER_RESERVOIR: 16
    K_EXAMPLES_PER_CLASS: 4
    NUM_STEPS_RANDOM: 4
    REFRESH_EVERY_N_STEPS:
    METRIC: 'euclidean'
    METRIC_KWARGS:

SOLVER:
  EARLY_STOPPING:
    METRIC_NAME: top_1_acc
