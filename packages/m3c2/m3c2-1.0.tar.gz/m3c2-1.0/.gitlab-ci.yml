image: python:3.9

stages:
  - deploy

before_script:
  - apt-get -y update && apt-get -y --no-install-recommends install libfftw3-dev libgsl-dev
  - pip install numpy cython xarray h5py astropy scipy matplotlib 
  - pip install lisaconstants
  - pip install git+https://oauth2:$CI_LDC_TOKEN@gitlab.in2p3.fr/LISA/LDC.git@develop
  - pip install . 

pages:
  stage: deploy
  script:
  - pip3 install --no-cache-dir mistune==0.8.4 sphinx sphinx_rtd_theme m2r2 nbconvert
  - cd test
  - jupyter nbconvert demo*.ipynb --to markdown
  - cd ../doc
  - cp ../test/demo*.md .
  - cp -r ../test/demo*_files .
  - sphinx-build -b html . ../public
  artifacts:
    paths:
    - public
  only:
  - master
